# Listen 80

LoadModule actions_module modules/mod_actions.so
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so
LoadModule proxy_wstunnel_module modules/mod_proxy_wstunnel.so

<Directory "/var/www">
  Options Indexes FollowSymLinks
  AllowOverride All
</Directory>

<VirtualHost *:80>
  DocumentRoot "/var/www/localhost/htdocs/public"

  ProxyPassMatch "(?!:/ws)" "fcgi://fpm:9000/app/public/index.php"

  <Location "/ws">
    ProxyPass "ws://fpm:8090/"
    ProxyPassReverse "ws://fpm:8090/"
  </Location>
</VirtualHost>